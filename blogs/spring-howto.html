<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Spring Web Develop HOWTO</title>
<!-- 2016-01-20 三 19:18 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="root" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="/styles/readtheorg/css/readtheorg.css"/>
<script src="/jslib/jquery-2.1.4.min.js"></script>
<script src="/jslib/bootstrap.min.js"></script>
<script type="text/javascript" src="/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Spring Web Develop HOWTO</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 前言</a></li>
<li><a href="#sec-2">2. Spring 解决什么问题</a>
<ul>
<li><a href="#sec-2-1">2.1. 框架的作用</a>
<ul>
<li><a href="#sec-2-1-1">2.1.1. 框架消除重复代码</a></li>
<li><a href="#sec-2-1-2">2.1.2. 框架消除相似代码</a></li>
</ul>
</li>
<li><a href="#sec-2-2">2.2. 程序是什么</a></li>
<li><a href="#sec-2-3">2.3. 程序</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Spring 如何抽象输入和输出</a>
<ul>
<li><a href="#sec-3-1">3.1. 基于原生的Servlet如何编程</a></li>
<li><a href="#sec-3-2">3.2. Spring 对输入的抽象</a>
<ul>
<li><a href="#sec-3-2-1">3.2.1. RestController</a></li>
<li><a href="#sec-3-2-2">3.2.2. RequestMapping</a></li>
<li><a href="#sec-3-2-3">3.2.3. PathVariable</a></li>
<li><a href="#sec-3-2-4">3.2.4. ReqestParam</a></li>
<li><a href="#sec-3-2-5">3.2.5. CookieValue 和 RequestHeader</a></li>
<li><a href="#sec-3-2-6">3.2.6. MatrixVariable</a></li>
<li><a href="#sec-3-2-7">3.2.7. RequestBody</a></li>
<li><a href="#sec-3-2-8">3.2.8. 绑定到对象</a></li>
<li><a href="#sec-3-2-9">3.2.9. 参数校验</a></li>
<li><a href="#sec-3-2-10">3.2.10. 原生态的输入</a></li>
<li><a href="#sec-3-2-11">3.2.11. Spring 对 RestController 中函数原型的要求</a></li>
</ul>
</li>
<li><a href="#sec-3-3">3.3. Spring 对输出的抽象</a>
<ul>
<li><a href="#sec-3-3-1">3.3.1. 返回String</a></li>
<li><a href="#sec-3-3-2">3.3.2. 返回对象</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 前言</h2>
<div class="outline-text-2" id="text-1">
<p>
2015年10月以前，我做c，c++，perl，lua开发，一直崇尚简洁。虽然很早就读过 thinking in java，但是一直没有涉足java开发，java给我两个感觉，一是笨重，而是庞杂，这里面有各种框架的功劳，看到诸多形形色色的框架，就不寒而栗。
</p>

<p>
2015年10月以后，终于不得不接触java开发，首当其冲的就是spring。一开始就被各种概念整懵了，IOC，DI，AOP，完全搞不懂这些东西是干啥的，也不知道引入它们的目的。徘徊了一个月，终于恍然大悟，spring其实很简单，如果有人点拨，学习spring的过程不至于这么曲折。随后，面试了一些java开发者，发现大家都知道spring，但是对spring的理解和使用都比较肤浅。本文试图由浅入深的讲解spring的本质是啥，如何最大限度的利用spring。
</p>

<p>
本文基于Spring4，主要讲解Rest风格的编程，不涉及到View部分。本文也不求面面俱到，只求领人入门，有更复杂的需求，尽可以翻看文档，Spring不会让你失望，只有想不到，没有做不到。
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Spring 解决什么问题</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> 框架的作用</h3>
<div class="outline-text-3" id="text-2-1">
<p>
框架五花八门，无处不在，框架解决的问题各式各样，但从编程实践的角度来看，框架是为了让程序更优雅。
</p>
</div>

<div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> 框架消除重复代码</h4>
</div>

<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2"><span class="section-number-4">2.1.2</span> 框架消除相似代码</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
框架是一种抽象，抽象层次越高，上述好处越多，当然，可能相应的灵活性就少很多。
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> 程序是什么</h3>
<div class="outline-text-3" id="text-2-2">
<p>
这个问题似乎太简单，但一时又不知从何说起。先看个简单的程序，hello.pl
</p>
<div class="org-src-container">

<pre class="src src-perl"><span style="color: #ffff00;">#</span><span style="color: #ffff00;">!/usr/bin/perl</span>
<span style="color: #00ffff; font-weight: bold;">my</span> <span style="color: #ffff00;">$name</span> = <span style="color: #ff83fa;">shift</span> || <span style="color: #00ff00;">"friend s"</span>;
<span style="color: #ff83fa;">print</span> <span style="color: #00ff00;">"hello $name\n"</span>;
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh">$ ./hello.pl spring
hello spring
</pre>
</div>

<p>
这个程序异常简单，它接受字符串，输出字符串。那么复杂的程序呢？我们考虑http服务器，比如jetty，它的输入输出是什么？
</p>

<pre class="example">
# curl http://dev/api/login?jsonp=x -vv
&gt; GET /api/login?jsonp=x HTTP/1.1
&gt; User-Agent: curl/7.41.0
&gt; Host: dev
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; Server: nginx/1.8.0
&lt; Date: Thu, 31 Dec 2015 02:43:19 GMT
&lt; Content-Type: application/javascript
&lt; Transfer-Encoding: chunked
&lt; Connection: keep-alive
&lt; X-Content-Type-Options: nosniff
&lt; X-XSS-Protection: 1; mode=block
&lt; Cache-Control: no-cache, no-store, max-age=0, must-revalidate
&lt; Pragma: no-cache
&lt; Expires: 0
&lt; X-Frame-Options: DENY
&lt;
/**/x({"code":400,"message":"bad request","data":{"password":"password is required"}});
</pre>

<p>
这里我们用curl模拟http请求， <code>输入点</code> 包括
</p>
<ul class="org-ul">
<li>HTTP Method，这里是 <code>GET</code> ，此外常用的还有 <code>POST PUT DELETE</code>
</li>
<li>请求 <code>url</code> ，包括 <code>path</code> 这里是 <code>/api/login</code> ，和 <code>querystring</code> ，这里是 <code>jsonp=x</code> , <code>querystring</code> 是可选的
</li>
<li>请求 <code>header</code> ，例如 Host，Accept，有些header比其它header要重要一些，比如cookie。
</li>
<li>请求 <code>body</code> ，这里body为空，一般请求 <code>POST PUT</code> 才需要body。
</li>
</ul>

<p>
<code>输出点</code> 包括：
</p>
<ul class="org-ul">
<li>HTTP code，这里是 ~200~。
</li>
<li>响应 <code>header</code> ，例如 Content-Type
</li>
<li>响应 <code>body</code> ，这里是 /**/开头的行
</li>
</ul>

<p>
上面的 <code>输入</code> 通过 <code>tcp</code> 协议传送给jetty，jetty通过 <code>tcp</code> 协议将 <code>输出</code> 回传给用户。这里针对输入和输出的规定，构成了 <code>http</code> 协议的内容， <code>http</code> 协议并没有规定输出 <code>body</code> 的格式。
</p>

<p>
从简单的 HelloWorld，到复杂的Web应用，程序的功能，无非都是解析输入，产生输出。程序使用程序语言编写的，程序语言规定了数据类型（结构），程序中的逻辑都是通过操作程序支持的数据类型实现的。我们需要在程序开始时，把输入转成程序语言支持的数据类型，在程序结束时，把程序语言支持的数据类型转成响应的输出。
</p>

<p>
对 HelloWorld 而言， <code>输入点</code> 很简单，是一个命令行参数，对Web应用而言， <code>输入点</code> 就复杂很多，如何把 <code>输入点</code> 的数据转成编程语言支持的数据类型，正是框架做的事情。
</p>

<p>
除了数据转换，框架还提供了机制，可以校验数据有效性。
</p>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> 程序</h3>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Spring 如何抽象输入和输出</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> 基于原生的Servlet如何编程</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Servlet是一套标准，java开发者可以使用它开发WEB应用，运行Servlet的web服务器称为Servlet容器，常见的Servlet容器有jetty，tomcat等。
</p>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #00ffff; font-weight: bold;">import</span> <span style="color: #ff00ff;">java</span>.<span style="color: #ff00ff;">io</span>.*;
<span style="color: #00ffff; font-weight: bold;">import</span> <span style="color: #ff00ff;">javax</span>.<span style="color: #ff00ff;">servlet</span>.*;
<span style="color: #00ffff; font-weight: bold;">import</span> <span style="color: #ff00ff;">javax</span>.<span style="color: #ff00ff;">servlet</span>.<span style="color: #ff00ff;">http</span>.*;

<span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ffff; font-weight: bold;">class</span> <span style="color: #00ff00;">HelloWorld</span> <span style="color: #00ffff; font-weight: bold;">extends</span> <span style="color: #00ff00;">HttpServlet </span>
<span style="color: #00ff00;">{</span>
<span style="color: #00ff00;">  public void doGet(HttpServletRequest</span> <span style="color: #ffff00;">request</span>,
                    <span style="color: #00ff00;">HttpServletResponse</span> <span style="color: #ffff00;">response</span>)
            <span style="color: #00ffff; font-weight: bold;">throws</span> <span style="color: #00ff00;">ServletException</span>, <span style="color: #00ff00;">IOException</span> {
    <span style="color: #00ff00;">String</span> <span style="color: #ffff00;">name</span> = request.getParameter(<span style="color: #00ff00;">"name"</span>);
    response.setContentType(<span style="color: #00ff00;">"text/html"</span>);

    <span style="color: #ffff00;">// </span><span style="color: #ffff00;">Actual logic goes here.</span>
    <span style="color: #00ff00;">PrintWriter</span> <span style="color: #ffff00;">out</span> = response.getWriter();
    out.println(<span style="color: #00ff00;">"&lt;h1&gt; Hello "</span> + name + <span style="color: #00ff00;">"&lt;/h1&gt;"</span>);
  }
}
</pre>
</div>

<p>
除了上述函数，我们还需要在 web.xml 配置url和处理函数的对应关系
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;<span style="color: #0000ff; font-weight: bold;">servlet</span>&gt;
   &lt;<span style="color: #0000ff; font-weight: bold;">servlet-name</span>&gt;HelloWorld&lt;/<span style="color: #0000ff; font-weight: bold;">servlet-name</span>&gt;
   &lt;<span style="color: #0000ff; font-weight: bold;">servlet-class</span>&gt;HelloWorld&lt;/<span style="color: #0000ff; font-weight: bold;">servlet-class</span>&gt;
&lt;/<span style="color: #0000ff; font-weight: bold;">servlet</span>&gt;

&lt;<span style="color: #0000ff; font-weight: bold;">servlet-mapping</span>&gt;
   &lt;<span style="color: #0000ff; font-weight: bold;">servlet-name</span>&gt;HelloWorld&lt;/<span style="color: #0000ff; font-weight: bold;">servlet-name</span>&gt;
   &lt;<span style="color: #0000ff; font-weight: bold;">url-pattern</span>&gt;/HelloWorld&lt;/<span style="color: #0000ff; font-weight: bold;">url-pattern</span>&gt;
&lt;/<span style="color: #0000ff; font-weight: bold;">servlet-mapping</span>&gt;
</pre>
</div>

<p>
这个过程非常直观，Servlet容器收到WEB请求，根据url和web.xml的配置，选择相应的处理类处理。使用 <code>HttpServletRequest HttpServletResponse</code> 表示输入和输出，这个抽象层次太低了，本例中为了获取 <code>querystring</code> 中的name参数，需要调用相应的函数。如果可以直接把 <code>querystring</code> 中的name参数绑定到一个 <b>String类型的变量</b> 抽象层次就高很多。
</p>

<p>
另外url和url处理类在不同的地方，不能一眼看出url的处理逻辑。
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Spring 对输入的抽象</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Spring提供了非常简单的机制，将 <code>输入点</code> 的数据转成java支持的数据类型， <code>long String List class</code> 等。
</p>
<ul class="org-ul">
<li>通过 <code>RestController</code> 和 <code>RequestMapping</code> 将 url 映射到具体的处理函数
</li>
<li>通过 <code>PathVariable</code> 和 <code>RequestParam</code> 将url的内容和querystring映射到java变量
</li>
<li>把 querystring 映射成java对象
</li>
<li>通过 <code>RequestHeader</code> 把 <code>header</code> 的值映射为java变量
</li>
</ul>

<p>
此外可以组合使用上述方法。如下代码将详细讲述映射（绑定）是如何发生的。
</p>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #ff00ff;">@RestController</span>
<span style="color: #ff00ff;">@RequestMapping</span>(<span style="color: #00ff00;">"/api"</span>)
<span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ffff; font-weight: bold;">class</span> <span style="color: #00ff00;">EchoController</span> {

  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ffff; font-weight: bold;">static</span> <span style="color: #00ffff; font-weight: bold;">class</span> <span style="color: #00ff00;">Profile</span> {
    <span style="color: #ff00ff;">@NotBlank</span>(message = <span style="color: #00ff00;">"name is required"</span>)
    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">String</span> <span style="color: #ffff00;">name</span>;

    <span style="color: #ff00ff;">@Pattern</span>(regexp = <span style="color: #00ff00;">"\\d{11,15}"</span>, message = <span style="color: #00ff00;">"phone is required"</span>)
    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">String</span> <span style="color: #ffff00;">phone</span>;

    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">List</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">favoriteColor</span>;

    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">void</span> <span style="color: #0000ff; font-weight: bold;">setName</span>(<span style="color: #00ff00;">String</span> <span style="color: #ffff00;">name</span>) {
      <span style="color: #00ffff; font-weight: bold;">this</span>.name = name;
    }
    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">void</span> <span style="color: #0000ff; font-weight: bold;">setPhone</span>(<span style="color: #00ff00;">String</span> <span style="color: #ffff00;">phone</span>) {
      <span style="color: #00ffff; font-weight: bold;">this</span>.phone = phone;
    }
    <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">void</span> <span style="color: #0000ff; font-weight: bold;">setFavoriteColor</span>(<span style="color: #00ff00;">List</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">color</span>) {
      <span style="color: #00ffff; font-weight: bold;">this</span>.favoriteColor = color;
    }
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">OptionalLong is not support now, use Optional&lt;Long&gt; instead of</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/power/5</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/power/5/3</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = {<span style="color: #00ff00;">"/power/{base}"</span>, <span style="color: #00ff00;">"/power/{base}/{power}"</span>}, method = <span style="color: #ff00ff;">RequestMethod</span>.GET)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">long</span> <span style="color: #0000ff; font-weight: bold;">getPower</span>(<span style="color: #ff00ff;">@PathVariable</span> <span style="color: #00ff00;">long</span> <span style="color: #ffff00;">base</span>, <span style="color: #ff00ff;">@PathVariable</span>(<span style="color: #00ff00;">"power"</span>) <span style="color: #00ff00;">Optional</span>&lt;<span style="color: #00ff00;">Long</span>&gt; <span style="color: #ffff00;">powerOpt</span>) {
    <span style="color: #00ff00;">long</span> <span style="color: #ffff00;">power</span> = powerOpt.orElse(2L);
    <span style="color: #00ffff; font-weight: bold;">return</span> (<span style="color: #00ff00;">long</span>) Math.pow(base, power);
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/upper/hello</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/upper?qs=world</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = {<span style="color: #00ff00;">"/upper"</span>, <span style="color: #00ff00;">"/upper/{upper}"</span>}, method = <span style="color: #ff00ff;">RequestMethod</span>.GET)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">String</span> <span style="color: #0000ff; font-weight: bold;">getUpper</span>(
    <span style="color: #ff00ff;">@PathVariable</span> <span style="color: #00ff00;">Optional</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">upper</span>,
    <span style="color: #ff00ff;">@RequestParam</span>(required = <span style="color: #ff00ff;">false</span>, defaultValue = <span style="color: #00ff00;">"Hello world"</span>) <span style="color: #00ff00;">String</span> <span style="color: #ffff00;">qs</span>) {
    <span style="color: #00ffff; font-weight: bold;">if</span> (upper.isPresent()) <span style="color: #00ffff; font-weight: bold;">return</span> upper.get().toUpperCase();
    <span style="color: #00ffff; font-weight: bold;">return</span> qs.toUpperCase();
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/books -H "Accept: text/plain"</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/books"</span>, produces = <span style="color: #00ff00;">"text/plain"</span>)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">String</span> <span style="color: #0000ff; font-weight: bold;">getBooksText</span>() {
    <span style="color: #00ffff; font-weight: bold;">return</span> <span style="color: #00ff00;">"Mastering Spring MVC,Spring in Action"</span>;
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/books</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/books"</span>)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">List</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #0000ff; font-weight: bold;">getBooks</span>() {
    <span style="color: #00ffff; font-weight: bold;">return</span> Arrays.asList(<span style="color: #00ff00;">"Mastering Spring MVC"</span>, <span style="color: #00ff00;">"Spring in Action"</span>);
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl -X PUT dev:8180/api/profile -d '{"name": "zzyong", "phone": 12345678901}' -H "Content-Type: application/octet-stream"</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/profile"</span>, method = <span style="color: #ff00ff;">RequestMethod</span>.PUT,
                  consumes = <span style="color: #00ff00;">"application/octet-stream"</span>)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">void</span> <span style="color: #0000ff; font-weight: bold;">submitProfile</span>(<span style="color: #00ff00;">HttpServletRequest</span> <span style="color: #ffff00;">request</span>, <span style="color: #00ff00;">HttpServletResponse</span> <span style="color: #ffff00;">response</span>)
    <span style="color: #00ffff; font-weight: bold;">throws</span> <span style="color: #00ff00;">IOException</span> {
    <span style="color: #00ff00;">InputStream</span> <span style="color: #ffff00;">input</span> = request.getInputStream();
    <span style="color: #00ff00;">OutputStream</span> <span style="color: #ffff00;">output</span> = response.getOutputStream();

    <span style="color: #00ff00;">byte</span>[] <span style="color: #ffff00;">buffer</span> = <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">byte</span>[512];
    <span style="color: #00ff00;">int</span> <span style="color: #ffff00;">n</span>;
    <span style="color: #00ffff; font-weight: bold;">while</span> ((n = input.read(buffer)) &gt; 0) {
      output.write(buffer, 0, n);
    }
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl -X PUT dev:8180/api/profile -d '{"name": "zzyong", "phone": 12345678901}' -H "Content-Type: application/json"  </span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/profile"</span>, method = <span style="color: #ff00ff;">RequestMethod</span>.PUT, consumes = <span style="color: #00ff00;">"application/json"</span>)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">String</span> <span style="color: #0000ff; font-weight: bold;">submitProfileJson</span>(<span style="color: #ff00ff;">@RequestBody</span> <span style="color: #00ff00;">String</span> <span style="color: #ffff00;">json</span>) {
    <span style="color: #00ffff; font-weight: bold;">return</span> json;
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl -X PUT "dev:8180/api/profile" -d 'name=zzyong&amp;phone=12345678901&amp;favoriteColor=red,green' -vv</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">Content-Type: application/x-www-form-urlencoded</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl -X PUT "dev:8180/api/profile" -F 'name=zzyong' -F 'phone=12345678901' -F 'favoriteColor=red,green' -vv</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">Content-Type: multipart/form-data; boundary=------------------------c00a4e11cd9e4e67</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/profile"</span>, method= <span style="color: #ff00ff;">RequestMethod</span>.PUT)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">ResponseEntity</span> <span style="color: #0000ff; font-weight: bold;">submitProfileForm</span>(<span style="color: #ff00ff;">@Valid</span> <span style="color: #00ff00;">Profile</span> <span style="color: #ffff00;">profile</span>, <span style="color: #00ff00;">BindingResult</span> <span style="color: #ffff00;">bindingResult</span>) {
    <span style="color: #00ffff; font-weight: bold;">if</span> (bindingResult.hasErrors()) {
      <span style="color: #00ff00;">Map</span>&lt;<span style="color: #00ff00;">String</span>, <span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">map</span> = <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">HashMap</span>&lt;&gt;();
      <span style="color: #00ffff; font-weight: bold;">for</span>(<span style="color: #00ff00;">FieldError</span> <span style="color: #ffff00;">error</span> : bindingResult.getFieldErrors()){
        map.put(error.getField(), error.getDefaultMessage());
      }
      <span style="color: #00ffff; font-weight: bold;">return</span> <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">ResponseEntity</span>&lt;<span style="color: #00ff00;">Map</span>&gt;(map, <span style="color: #ff00ff;">HttpStatus</span>.BAD_REQUEST);      
    } <span style="color: #00ffff; font-weight: bold;">else</span> {
      <span style="color: #00ffff; font-weight: bold;">return</span> <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">ResponseEntity</span>&lt;<span style="color: #00ff00;">Profile</span>&gt;(profile, <span style="color: #ff00ff;">HttpStatus</span>.OK);
    }
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl "dev:8180/api/profile" -H "user: bob" -H "password: secret" -vv</span>
  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl "dev:8180/api/profile" -H "Cookie: uid=btxaergfe" -vv</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/profile"</span>, method = <span style="color: #ff00ff;">RequestMethod</span>.GET)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">Profile</span> <span style="color: #0000ff; font-weight: bold;">getProfile</span>(
    <span style="color: #ff00ff;">@CookieValue</span>(<span style="color: #00ff00;">"uid"</span>) <span style="color: #00ff00;">Optional</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">uid</span>,
    <span style="color: #ff00ff;">@RequestHeader</span>(<span style="color: #00ff00;">"user"</span>) <span style="color: #00ff00;">Optional</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">user</span>,
    <span style="color: #ff00ff;">@RequestHeader</span>(<span style="color: #00ff00;">"password"</span>) <span style="color: #00ff00;">Optional</span>&lt;<span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">pass</span>) {
    <span style="color: #00ff00;">Profile</span> <span style="color: #ffff00;">profile</span> = <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">Profile</span>();
    profile.name = <span style="color: #00ff00;">"bob"</span>;
    <span style="color: #00ffff; font-weight: bold;">if</span> (uid.isPresent() || (user.isPresent() &amp;&amp; pass.isPresent())) {
      profile.phone = <span style="color: #00ff00;">"31415926535"</span>;
      <span style="color: #00ffff; font-weight: bold;">return</span> profile;
    } <span style="color: #00ffff; font-weight: bold;">else</span> {
      <span style="color: #00ffff; font-weight: bold;">return</span> profile;
    }
  }

  <span style="color: #ffff00;">// </span><span style="color: #ffff00;">curl dev:8180/api/x/100;name=apple;color=red/y/200;name=orange</span>
  <span style="color: #ff00ff;">@RequestMapping</span>(value = <span style="color: #00ff00;">"/x/{x}/y/{y}"</span>)
  <span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">Map</span> <span style="color: #0000ff; font-weight: bold;">coordinateProfile</span>(
    <span style="color: #ff00ff;">@PathVariable</span> <span style="color: #00ff00;">int</span> <span style="color: #ffff00;">x</span>, <span style="color: #ff00ff;">@MatrixVariable</span>(pathVar = <span style="color: #00ff00;">"x"</span>) <span style="color: #00ff00;">Map</span>&lt;<span style="color: #00ff00;">String</span>, <span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">xCnf</span>,
    <span style="color: #ff00ff;">@PathVariable</span> <span style="color: #00ff00;">int</span> <span style="color: #ffff00;">y</span>, <span style="color: #ff00ff;">@MatrixVariable</span>(pathVar = <span style="color: #00ff00;">"y"</span>) <span style="color: #00ff00;">Map</span>&lt;<span style="color: #00ff00;">String</span>, <span style="color: #00ff00;">String</span>&gt; <span style="color: #ffff00;">yCnf</span>) {
    <span style="color: #00ffff; font-weight: bold;">return</span> <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">HashMap</span>&lt;<span style="color: #00ff00;">Integer</span>, <span style="color: #00ff00;">Map</span>&gt;() {{
      put(x, xCnf);
      put(y, yCnf);
    }};
  }
}
</pre>
</div>
</div>

<div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> RestController</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
通过RestController标注， <code>EchoController</code> 中相应的函数会成为相应url的处理函数。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-2" class="outline-4">
<h4 id="sec-3-2-2"><span class="section-number-4">3.2.2</span> RequestMapping</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
当RequestMapping用来标类时，相应的path成为该类中，所有url的前缀，本例中所有url都自动加 /api 前缀。
RequestMapping 常用参数如下：
</p>
<ul class="org-ul">
<li>value 指定url，可以指定多个，如 <code>getPower</code> 和 <code>getUpper</code>
</li>
<li>method 指定 HTTP 方法，默认不限制
</li>
<li>produces 指定 Accept，只有Accept符合的请求才接受
</li>
<li>consumes 指定 Content-Type，只有Content-Type符合的请求才接受
</li>
</ul>

<p>
当同一个url可以产生多种格式的输出时，请求通过 <code>Accept</code> 头指定接受的格式，选择匹配的 <code>produces</code> 处理函数，产生相应输出。
</p>

<p>
例如，指定 <code>Accept</code> 只接受文本格式时，/api/books 返回逗号分隔的字符串，默认返回json。
</p>
<div class="org-src-container">

<pre class="src src-sh">$ curl dev:8180/api/books -H <span style="color: #00ff00;">"Accept: text/plain"</span>
Mastering Spring MVC,Spring<span style="color: #00ffff; font-weight: bold;"> in</span> Action

$ curl dev:8180/api/books
[<span style="color: #00ff00;">"Mastering Spring MVC"</span>,<span style="color: #00ff00;">"Spring in Action"</span>]
</pre>
</div>

<p>
当同一个url接受多种格式的输入时，请求通过 <code>Content-Type</code> 指定输入的格式，选择匹配的 <code>consumes</code> 处理函数。
</p>

<p>
例如，指定 <code>Content-Type</code> 为 application/json 时，可以输入原生的Json数据，而不指定可以接受任意类型。这个主要影响数据绑定，Spring支持Content-Type为 application/x-www-form-urlencoded 和 multipart/form-data 的绑定
</p>

<div class="org-src-container">

<pre class="src src-sh">$ curl -X PUT dev:8180/api/profile -d <span style="color: #00ff00;">'{"name": "zzyong", "phone": 12345678901}'</span> -H <span style="color: #00ff00;">"Content-Type: application/json"</span>
{<span style="color: #00ff00;">"name"</span>: <span style="color: #00ff00;">"zzyong"</span>, <span style="color: #00ff00;">"phone"</span>: 12345678901}

$ curl -X PUT dev:8180/api/profile -d <span style="color: #00ff00;">'name=zzyong&amp;phone=12345678901&amp;favoriteColor=red,green'</span>
{<span style="color: #00ff00;">"name"</span>:<span style="color: #00ff00;">"zzyong"</span>,<span style="color: #00ff00;">"phone"</span>:<span style="color: #00ff00;">"12345678901"</span>,<span style="color: #00ff00;">"favoriteColor"</span>:[<span style="color: #00ff00;">"red"</span>,<span style="color: #00ff00;">"green"</span>]}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2-3" class="outline-4">
<h4 id="sec-3-2-3"><span class="section-number-4">3.2.3</span> PathVariable</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
<code>PathVariable</code> 用于绑定url模板中的参数，它只有一个参数，用于指定变量在url模板的名字。
</p>

<p>
在 <code>getPower</code> 中，url模板为 {"/power/{base}", "/power/{base}/{power}"}，变量base的名字和{base}相同，而变量powerOpt和{power}不同，所以使用 <code>@PathVariable("power")</code> 指定模板的名字。
</p>

<p>
此外， <code>RequestMapping</code> 指定了两个url，power是可选的，此时可以使用Java8的新特性，Optional。虽然Java8提供了 OptionLong 作为 Optional&lt;Long&gt; 的优化，似乎目前spring并不支持前者。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-4" class="outline-4">
<h4 id="sec-3-2-4"><span class="section-number-4">3.2.4</span> ReqestParam</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
<code>RequestParam</code> 用于绑定 <code>querystring</code> 和 <code>requestbody</code> 中的参数，其主要参数有
</p>
<ul class="org-ul">
<li>required 指定参数是否必须，默认为ture
</li>
<li>defaultValue 当required为false时，指定默认值，必须是字符串串，和绑定变量的类型无关。例如 1 写成 "1"
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-2-5" class="outline-4">
<h4 id="sec-3-2-5"><span class="section-number-4">3.2.5</span> CookieValue 和 RequestHeader</h4>
<div class="outline-text-4" id="text-3-2-5">
<p>
<code>CooieValue</code> 用于绑定 <code>Cookie</code> 中的某一个， <code>RequestHeader</code> 用于绑定header
在 getProfile 中，用了Optional，因为这些都是可选的。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-6" class="outline-4">
<h4 id="sec-3-2-6"><span class="section-number-4">3.2.6</span> MatrixVariable</h4>
<div class="outline-text-4" id="text-3-2-6">
<p>
<code>MatrixVariable</code> 用于获取url的某段path的选项，默认是关闭的，需要通过一个配置打开，具体来说就是创建一个 <code>Bean</code> 。
</p>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #ff00ff;">@Bean</span>
<span style="color: #00ffff; font-weight: bold;">public</span> <span style="color: #00ff00;">RequestMappingHandlerMapping</span> <span style="color: #0000ff; font-weight: bold;">requestMappingHandlerMapping</span>() {
  <span style="color: #00ff00;">RequestMappingHandlerMapping</span> <span style="color: #ffff00;">r</span> = <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #00ff00;">RequestMappingHandlerMapping</span>();
  r.setRemoveSemicolonContent(<span style="color: #ff00ff;">false</span>);
  <span style="color: #00ffff; font-weight: bold;">return</span> r;
}
</pre>
</div>

<p>
<code>MatrixVariable</code> 主要参数是一个 <code>pathVar</code> 用于指定相应的url模板部分，如果不指定，全部的matrix都会放到一个 <code>Map</code> 中去。
</p>

<p>
<code>MatrixVariable</code> 只是请求url有所不同，并不影响 <code>RequestMapping</code> 的形式。例如 x/{x}/y/{y} 可以映射下面的请求
</p>

<div class="org-src-container">

<pre class="src src-sh">$ curl <span style="color: #00ff00;">'http://dev:8180/api/x/100;name=apple;color=red/y/200;name=orange'</span>
{<span style="color: #00ff00;">"100"</span>:{<span style="color: #00ff00;">"name"</span>:[<span style="color: #00ff00;">"apple"</span>],<span style="color: #00ff00;">"color"</span>:[<span style="color: #00ff00;">"red"</span>]},<span style="color: #00ff00;">"200"</span>:{<span style="color: #00ff00;">"name"</span>:[<span style="color: #00ff00;">"orange"</span>]}}
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-3-2-7" class="outline-4">
<h4 id="sec-3-2-7"><span class="section-number-4">3.2.7</span> RequestBody</h4>
<div class="outline-text-4" id="text-3-2-7">
<p>
对于 <code>Content-Type</code> 为 <code>application/x-www-form-urlencoded</code> 和 <code>multipart/form-data</code> 的请求，通常会把 <code>requestbody</code> 以key-value的形式绑定到各个变量。但有时需要获取整个 <code>requestbody</code> 的内容，此时可以用 <code>RequestBody</code> ，如 <code>submitProfileJson</code> 所示。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-8" class="outline-4">
<h4 id="sec-3-2-8"><span class="section-number-4">3.2.8</span> 绑定到对象</h4>
<div class="outline-text-4" id="text-3-2-8">
<p>
<code>submitProfileForm</code> 的参数是 <code>(@Valid Profile profile, BindingResult bindingResult)</code> ，spring会把 <code>querystring</code> 和 <code>requestbody</code> 中的值绑定到 <code>Profile</code> 。假如 <code>requestbody</code> 是 <code>name=zzyong&amp;phone=12345678901&amp;favoriteColor=red,green</code> ，spring解析到name时，会调用Profile的 <code>setName</code> 函数，解析到favoriteColor时，会调用 <code>setFavoriteColor</code> 。注意 Profile中的相关字段，必须有set方法，仅仅是public时不够的。
</p>

<p>
除了基本的类型转换，String转long外， <b>逗号分隔</b> 的字符串，也会被转成List。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-9" class="outline-4">
<h4 id="sec-3-2-9"><span class="section-number-4">3.2.9</span> 参数校验</h4>
<div class="outline-text-4" id="text-3-2-9">
<p>
使用场景参考 <code>Profile</code> 和 <code>submitProfileForm</code> ，可选的校验类型与spring无关，常见的校验
</p>
<ul class="org-ul">
<li>DateTimeFormat @DateTimeFormat(pattern = "yyyy-MM-dd'T'HH:mm:ss")
</li>
<li>Pattern @Pattern(regexp = "\\d{11,15}")
</li>
<li>NotBlank
</li>
<li>NotNull
</li>
<li>Min Max
</li>
<li>Size
</li>
</ul>

<p>
Valid 用于校验参数的合法性，并把校验结果存放到 <code>BindingResult</code> 中。 例如：
</p>
<div class="org-src-container">

<pre class="src src-sh">$ curl -X PUT <span style="color: #00ff00;">"dev:8180/api/profile"</span> -d <span style="color: #00ff00;">'phone=12345678901&amp;favoriteColor=red,green'</span>
{<span style="color: #00ff00;">"name"</span>:<span style="color: #00ff00;">"name is required"</span>}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2-10" class="outline-4">
<h4 id="sec-3-2-10"><span class="section-number-4">3.2.10</span> 原生态的输入</h4>
<div class="outline-text-4" id="text-3-2-10">
<p>
如果上述绑定满足不了需求，仍然可以获得类似 <code>Servlet</code> 的参数，如 <code>submitProfileStream</code> 所示。
</p>
</div>
</div>

<div id="outline-container-sec-3-2-11" class="outline-4">
<h4 id="sec-3-2-11"><span class="section-number-4">3.2.11</span> Spring 对 RestController 中函数原型的要求</h4>
<div class="outline-text-4" id="text-3-2-11">
<p>
有过 <code>Servlet</code> 编程经验的人，初次看到 <code>RestController</code> 的代码，可能会惊讶于函数签名的千奇百怪。的确，很多框架，都是要求使用者继承一个类，覆盖一些方法，或者实现一些接口，函数原型并没有选择的余地。Spring不是这样， <code>RestController</code> 中的函数原型是任意的，Spring会根据注解和变量类型，做正确的函数调用。
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Spring 对输出的抽象</h3>
<div class="outline-text-3" id="text-3-3">
</div><div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1"><span class="section-number-4">3.3.1</span> 返回String</h4>
</div>
<div id="outline-container-sec-3-3-2" class="outline-4">
<h4 id="sec-3-3-2"><span class="section-number-4">3.3.2</span> 返回对象</h4>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: root</p>
<p class="date">Created: 2016-01-20 三 19:18</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
